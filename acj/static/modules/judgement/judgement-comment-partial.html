<div ng-controller="JudgementCommentController">
	<h1>Evaluation Comments</h1>
	<strong>Evaluator</strong>
	<select ng-model="search.userId" ng-options="id as name for (id, name) in students">
		<option value="">-- All Students --</option>
	</select>
	<strong>Criterion</strong>
	<select ng-model="search.criteriaId" ng-options="c.id as c.criterion.name for (k, c) in criteria">
		<option value="">-- All Criteria --</option>
	</select>

	<hr>

	<div ng-repeat="(key, comment) in comments | filter:commentFilter(search.userId, search.criteriaId) as results" style="font-size: .85em;">

		<!-- Comment Header -->
		<a ng-href="#/user/{{comment.postsforcomments.post.user.id}}">
			<img src="//www.gravatar.com/avatar/{{comment.postsforcomments.post.user.avatar}}?s=32&d=retro" />
		</a>
		<a ng-href="#/user/{{comment.postsforcomments.post.user.id}}">
			{{comment.postsforcomments.post.user.displayname}}
			<span ng-if="comment.postsforcomments.post.user.fullname">
				({{comment.postsforcomments.post.user.fullname}})
			</span>
			<span ng-if="!comment.postsforcomments.post.user.fullname">
				({{comment.postsforcomments.post.user.username}})
			</span>
		</a>
		<strong>commented</strong> on {{comment.postsforcomments.post.created | amDateFormat: 'MMM D @ h:mm a'}}:

		<!-- TODO: criteria -->

		<!-- Comment -->
		<div class="content" mathjax="comment.postsforcomments.post.content"
			 ng-bind-html="comment.postsforcomments.post.content">
		</div>

		<!-- Answers -->
		<a ng-click="answers(comment)">Answers</a>
		<!-- TODO: attachment -->
		<div mathjax="comment.judgement.answerpairing[comment.judgement.answerpairing.postsforanswers_id1].post.content"
			 ng-bind-html="comment.judgement.answerpairing[comment.judgement.answerpairing.postsforanswers_id1]['post']['content']"></div>
		<div mathjax="comment.judgement.answerpairing[comment.judgement.answerpairing.postsforanswers_id2].post.content"
			 ng-bind-html="comment.judgement.answerpairing[comment.judgement.answerpairing.postsforanswers_id2]['post']['content']"></div>

	</div>

	<!-- if no comments are available - eg. none submitted or after filter -->
	<div ng-if="results.length < 1">
		<h2>No comments are found</h2>
	</div>
</div>