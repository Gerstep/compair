<div ng-controller="ClassViewController">
	<div class="row">	
		<header class="col-sm-6">
			<h1><i class="fa fa-users"></i> Manage Users</h1>
		</header>
		<div class="col-sm-6 sub-nav">
			<a ng-href="#/course/{{course.id}}/group/import" class="btn btn-primary">
				<i class="fa fa-list-ul"></i>
				Assign Groups
			</a>
			<a ng-href="#/course/{{course.id}}/user/import" class="btn btn-primary">
				<i class="fa fa-upload"></i>
				Import Users
			</a>
			<!-- TO DO: button should compile the CSV file -->
			<!-- <a href="" class="btn btn-primary">
				<i class="fa fa-download"></i>
				Export Users
			</a> -->
		</div>
	</div>
	<!-- TO DO: reportFile to be replaced by whatever will be used on this page to create the CSV file -->
	<div class="alert alert-success text-center" ng-show="reportFile">
			<h4>File Complete</h4>
			<p>Your list of users is ready for <strong><a href="{{ reportFile }}">download <i class="fa fa-file-excel-o"></i></a></strong> now.</p>
	</div>
	<h2>Enrolled in {{course.name}}</h2>
	<hr />
	<ng-include class="pull-right" src="'modules/classlist/classlist-enrol-partial.html'"></ng-include>
	<h3>{{ classlist.length }} Users</h3>
	<table class="table table-striped">
		<tr class>
			<th>Action</th>
			<th>
				<a href="" ng-click="reverse = predicate == 'user.firstname' && !reverse; predicate = 'user.firstname'">
					First Name</a>
			</th>
			<th>
				<a href="" ng-click="reverse = predicate == 'user.lastname' && !reverse; predicate = 'user.lastname'">
					Last Name</a>
			</th>
			<th>
				<a href="" ng-click="reverse = predicate == 'user.student_no' && ! reverse; predicate = 'user.student_no'">
					Student Number</a>
			</th>
			<th>
				<a href="" ng-click="reverse = predicate == 'user.displayname' && !reverse; predicate = 'user.displayname'">
					Display Name</a>
			</th>
			<th>
				<a href="" ng-click="reverse = predicate == 'user.email' && !reverse; predicate = 'user.email'">
					Email</a>
			</th>
			<th>
				<a href="" ng-click="reverse = predicate == 'usertypeforcourse.name' && !reverse; predicate = 'usertypeforcourse.name'">
					Course Role</a>
			</th>
			<th ng-if="groups.length > 0">Group</th>
		</tr>
		<tr ng-repeat="user in classlist | orderBy:predicate:reverse">
			<td>
				<a href="#/user/{{user.user.id}}/edit" target="_blank">
					Edit
				</a>
			</td>
			<td>{{user.user.firstname}}</td>
			<td>{{user.user.lastname}}</td>
			<td>{{user.user.student_no}}</td>
			<td>{{user.user.displayname}}</td>
			<td>{{user.user.email}}</td>
			<td>{{user.usertypeforcourse.name}}</td>
			<td ng-if="groups.length > 0">
				<select ng-model="user.groups[0].groups_id" ng-options="g.id as g.name for g in groups"
						ng-change="update(user.user.id, user.groups[0].groups_id)">
					<option value="">-- None --</option>
				</select>
			</td>
		</tr>
	</table>
</div>
