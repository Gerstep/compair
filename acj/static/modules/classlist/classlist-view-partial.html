<div ng-controller="ClassViewController" class="manage-screen">
	
	<div class="row">	
		<header class="col-md-6">
			<h1><i class="fa fa-users"></i> Manage Users</h1>
		</header>
		<div class="col-md-6 sub-nav">
			<a ng-href="#/course/{{courseId}}/user/import" class="btn btn-primary">
				<i class="fa fa-upload"></i>
				Import Users
			</a>
			<a ng-href="#/course/{{courseId}}/user/group/import" class="btn btn-primary">
				<i class="fa fa-list-ul"></i>
				Assign Groups
			</a>
			<!-- TO DO: button should compile the CSV file -->
			<!-- <a href="" class="btn btn-primary">
				<i class="fa fa-download"></i>
				Export Users
			</a> -->
		</div>
	</div>
	
	<p class="intro-text">Drop or enrol individual users&mdash;who are already in the application&mdash;below. To create, drop, or enrol multiple users in a course at the same time, click Import Users above.</p>
	
	<!-- TO DO: reportFile to be replaced by whatever will be used on this page to create the CSV file -->
	<div class="alert alert-success text-center" ng-show="reportFile">
		<h4>File Complete</h4>
		<p>Your list of users is ready for <strong><a href="{{ reportFile }}">download <i class="fa fa-file-excel-o"></i></a></strong> now.</p>
	</div>

	<h2 >Enrolled in {{course_name}}</h2>
	<hr />

	<div class="row">
		<h3 class="col-md-2">{{ classlist.length }} Users</h3>
		<div class="col-md-10">
			<ng-include src="'modules/classlist/classlist-enrol-partial.html'"></ng-include>
		</div>
	</div>
	
	<div class="table-responsive">
		<table class="table table-striped">
			<thead>
				<tr class>
					<th>Action</th>
					<th>
						<a href="" ng-click="reverse = predicate == 'user.firstname' && !reverse; predicate = 'user.firstname'">
							First Name</a>
					</th>
					<th>
						<a href="" ng-click="reverse = predicate == 'user.lastname' && !reverse; predicate = 'user.lastname'">
							Last Name</a>
					</th>
					<th>
						<a href="" ng-click="reverse = predicate == 'user.student_no' && ! reverse; predicate = 'user.student_no'">
							Student Number</a>
					</th>
					<th>
						<a href="" ng-click="reverse = predicate == 'user.displayname' && !reverse; predicate = 'user.displayname'">
							Display Name</a>
					</th>
					<th>
						<a href="" ng-click="reverse = predicate == 'user.email' && !reverse; predicate = 'user.email'">
							Email</a>
					</th>
					<th>
						<a href="" ng-click="reverse = predicate == 'usertypeforcourse.name' && !reverse; predicate = 'usertypeforcourse.name'">
							Course Role</a>
					</th>
					<th ng-if="groups.length > 0">Group</th>
				</tr>
			</thead>
			<tbody>
				<tr ng-repeat="user in classlist | orderBy:predicate:reverse">
					<td>
						<!--<a href="#/user/{{user.user.id}}/edit" target="_blank">
							Edit
						</a>-->
						<a href="" confirmation-needed ng-click="unenrol(user.user.id)" keyword="user">
							Drop
						</a>
					</td>
					<td>{{user.user.firstname}}</td>
					<td>{{user.user.lastname}}</td>
					<td>{{user.user.student_no}}</td>
					<td><a ng-href="#/user/{{user.user.id}}">{{user.user.displayname}}<a/></td>
					<td>{{user.user.email}}</td>
					<td>
						<select ng-model="user.usertypeforcourse.id" ng-options="r.id as r.name for r in roles"
								ng-change="enrol(user.user.id, user.usertypeforcourse.id)"></select>
					</td>
					<td ng-if="groups.length > 0">
						<select ng-model="user.groups[0].groups_id" ng-options="g.id as g.name for g in groups"
								ng-change="update(user.user.id, user.groups[0].groups_id)">
							<option value="">- None -</option>
						</select>
					</td>
				</tr>
			</tbody>
		</table>
	</div>
	
</div>
