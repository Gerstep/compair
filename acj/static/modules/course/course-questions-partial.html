<div ng-controller="CourseQuestionsController" class="course-screen">
	<div class="row">
		<header class="col-sm-6">
			<h1><i class="fa fa-book"></i> {{course.name}}</h1>
		</header>
		<div class="col-sm-6 sub-nav">
			<span ng-if="canCreateQuestions">
				<a ng-href="#/course/{{course.id}}/question/create" 
					class="btn btn-primary" id="stepNav">
					<i class="fa fa-plus"></i>
					Add Question
				</a>
			</span>
			<span ng-if="canEditCourse">
				<a ng-href="#/course/{{course.id}}/configure" class="btn btn-primary">
					<i class="fa fa-edit"></i>
					Edit Course
				</a>
				<a ng-href="#/course/{{course.id}}/user" class="btn btn-primary">
					<i class="fa fa-users"></i>
					Manage Users
				</a>
			</span>
		</div>
	</div>
	
	<form class="form-inline searchCourse" role="search" ng-if="questions.length">
		<div class="form-group pull-right">
			<input class="form-control" type="text" ng-model="questionFilter"
				placeholder="Search for questions">
		</div>
	</form>
	
	<h2>Course questions</h2>
	
	<div ng-if="!questions.length">
		<hr />
		<p>No questions currently posted.</p>
		<p ng-if="canCreateQuestions">Would you like to <a ng-href="#/course/{{course.id}}/question/create">add a question</a>?</p>
	</div>
	

	
	<!-- Questions List -->
	<div class="row each-question"
		ng-repeat="question in questions | filter:questionFilter">
		<!-- Question Display -->
		<div class="col-sm-10 media">
			<!-- Gravatar, link to user profile -->
			<!-- 
			custom margin to fix tags being cut off on small screens when it goes
			to the second row, moved to padding in question-info
			<a class="pull-left" ng-href="#/user/" style="margin-right: 0;">
				<img class="media-object" src="//www.gravatar.com/avatar/{{question.post.user.avatar}}?s=48&d=retro">
			</a> -->
			<!-- Question Info -->
			<div class="media-body">
				<!-- Title -->
				<a ng-href="#/course/{{course.id}}/question/{{question.id}}">
					<h3 class="media-heading">
						<i class="fa fa-comments"></i> {{question.title}} &raquo;
						<span class="label label-danger" ng-if="!question.available">Unavailable</span>
					</h3>
				</a>
				<!-- Details -->
				<div mathjax ng-bind-html="question.post.content" class="question-desc"></div>
				<!-- Metadata -->
				<ul class="list-inline">
					<!-- Edit and Delete Links -->
					<li ng-if="canManagePosts || question.post.user.id == loggedInUserId">	
						<a ng-href="#/course/{{course.id}}/question/{{question.id}}/edit" title="Edit">
							Edit
						</a> 
					</li>
					<!-- Time Posted and Author -->
					<li>
						Posted by 
						<a ng-href="#/user/{{question.post.user.id}}">
							{{question.post.user.displayname}}
							<span ng-if="canManagePosts && question.post.user.fullname">({{question.post.user.fullname}})</span>
							<span ng-if="canManagePosts && !question.post.user.fullname">({{question.post.user.username}})</span>
						</a>
					</li>
					<!-- Total number of answers -->
					<li title="{{question.answers_count}} answers">
						{{question.answers_count}} answer<span ng-if="question.answers_count != 1">s</span>
					</li>
					<!-- Total number of comments -->
					<li title="{{question.total_comments_count}} comments"> 
						{{question.total_comments_count}} comment<span ng-if="question.total_comments_count != 1">s</span>
					</li>
					<!-- Judgements Left counter -->
					<li ng-if="!canManagePosts && question.judging_period" ng-class="{'label label-warning': question.left > 0}">
						{{question.left}} evaluation<span ng-if="question.left != 1">s</span> needed from you
					</li>
					<li ng-if="canManagePosts || question.post.user.id == loggedInUserId">
						<a ng-href="#/course/{{course.id}}/question/{{question.id}}/delete" title="Delete">
							<i class="fa fa-trash-o"></i>
						</a>
					</li>
					<!-- Question Tags -->
					<!-- <li class="label label-default">
						tag 1
					</li>
					<li class="label label-default">
						tag 2
					</li>
					<li class="label label-default">
						tag 3
					</li> -->
				</ul>
			</div>
		</div>
		<!-- Question Controls -->
		<div class="col-sm-2">
			<a class="btn btn-success" title="Answer Question"
				ng-href="#/course/{{course.id}}/question/{{question.id}}/answer/create" ng-show="canManagePosts || question.answer_period">
				Answer
			</a>
			<a class="btn btn-success" title="Evaluate Answers"
				ng-href="#/course/{{course.id}}/question/{{question.id}}/judgement" ng-if="!canManagePosts && question.judging_period">
				Evaluate
			</a>
		</div>
	</div>


</div>
