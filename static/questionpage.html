<div>
	<h2>Question Page</h2>

	<div class="navbar">
		<form class="searchCourse">
			Search Question:
			<input class="search-query" type="text" ng-model="search">
		</form>
		<a href="" class="btn btn-success pull-right" ng-click="check=!check" id="stepNav">
			<i class="icon-question-sign icon-large"></i> Create Question
		</a>
	</div>

	<div ng-show="check">
		<form class="createQuestion" name="createQuestion" ng-submit="submit()" novalidate>
			<label for="questionTitle">Question Title: </label>
			<input id="questionTitle" type="text" name="title" ng-model="title" required />
			<p class="text-error"
				ng-show="submitted && createQuestion.title.$error.required">
				<span class="label label-important"> 
					Error
				</span>
				A title is required for the question.
			</p>

			<div math-toolbar editor="myquestion" class="mathtoolbar"></div>
			<div hallo-editor name="question" ng-model="question" id="myquestion" class="entries" ng-mouseup="saveRange()" ng-keyup="saveRange()"></div>
			<p class="text-error" ng-show="submitted && !question">
				<span class="label label-important">Error</span>
				Please enter a question.
			</p>

			<a class="btn btn-info" ng-click="previewText(); showpreview=true;">
				<i class="icon-eye-open"></i> Preview
			</a>
			<a class="btn btn-primary" ng-click="submit(); submitted=true">
				<i class="icon-ok"></i> Submit
			</a>

			<div class="preview" ng-show="showpreview" mathjax-bind="preview">
			</div>
		</form>
	</div>

	<br>

	<ul class="postingsList">
		<li ng-repeat="question in questions | orderBy:orderProp:true | filter:searchFilter">
			<img src="http://www.gravatar.com/avatar/{{question.avatar}}?s=32&d=retro" class="avatar">
			<p class="authorHeader"><strong>{{question.author}}</strong> - {{question.time}}</p>
			<div class="opbuttons">
				<div class="row-fluid">
					<div class="col-md-12">
						<div class="row-fluid">
							<div class="col-md-4">
								<a href="#/answerpage/{{question.id}}" class="btn btn-info btn-small btnWidth" id="stepAnswer"> 
									<i class="icon-puzzle-piece icon-large"></i> Answer Page
								</a>
							</div>
							<div class="col-md-4 col-md-offset-1">
								<a href="#/judgepage/{{question.id}}" class="btn btn-inverse btn-small btnWidth" id="stepJudge" ng-show="question.count > 1"> 
									<i class="icon-legal icon-large"></i> Judge Answers
								</a>				
								<button class="btn btn-inverse btn-small disabled btnWidth" id="stepJudgeDisabled" ng-show="question.count <= 1" title="Not enough answers to judge yet!">
									<i class="icon-legal icon-large"></i> Judge Answers
								</button>
							</div>
						</div>
					</div>
				</div>
				<div class="row-fluid marginT5">
					<div class="col-md-12">
						<div class="row-fluid">
							<div class="col-md-4">
								<span class="label btnWidth top" ng-class="{'label-success': question.count > 1, 'label-warning': question.count == 1, 'label-important': question.count == 0}">{{question.count}} answer(s)</span>
							</div>
							<div class="col-md-4 col-md-offset-1">
								<a href="#/reviewjudge/{{question.id}}" class="btn btn-inverse btn-small btnWidth" ng-show="question.count > 1"> 
									<i class="icon-eye-open icon-large"></i> Review
								</a>				
								<button class="btn btn-inverse btn-small disabled btnWidth" id="stepJudgeDisabled" ng-show="question.count <= 1" title="Not enough answers have been judged yet!">
									<i class="icon-eye-open icon-large"></i> Review
								</button>
							</div>
						</div>
					</div>
				</div>	
				<div class="row-fluid marginT15">
					<div class="col-md-12">
						<div class="row-fluid">
							<div class="col-md-4">
								<a class="btn btn-small btnWidth" ng-show="login == question.author || instructor" 
									ng-click="switchEdits({{question.id}});newtitle=question.title;newquestion=question.content;showpreviewEdit=false;">
									<i class="icon-edit-sign icon-large"></i> Edit
								</a>
							</div>
							<div class="col-md-4 col-md-offset-1">
								<a class="btn btn-danger btn-small btnWidth" ng-show="login == question.author || instructor" ng-click="remove(question)">
									<i class="icon-trash icon-large"></i> Delete
								</a>			
							</div>				
						</div>				
					</div>				
				</div>				
			</div>

			
			<div ng-hide="switchEdits() == {{question.id}}" id="stepTitle">
				<h4 mathjax-bind="question.title"></h4>
				<a ng-click="full=!full" class="btn btn-mini" >
					<span ng-hide="full">
						<i class="icon-collapse"></i> Show
					</span>
					<span ng-show="full">
						<i class="icon-collapse-top"></i> Hide
					</span>
				</a>
				<div class="questionContent" ng-show="full" mathjax-bind="question.content"></div>
			</div>

			<div ng-show="switchEdits() == {{question.id}}">
				<form name="createQuestion" novalidate>
				Question Title: <input type="text" name="title" ng-model="newtitle" required>
				<p class="text-error"
					ng-show="submitted && createQuestion.title.$error.required">
					<span class="label label-important"> 
						Error
					</span>
					A title is required for the question.
				</p>
				<div math-toolbar editor="question{{question.id}}" class="mathtoolbar"></div>
				<div hallo-editor name="question" ng-model="newquestion" id="question{{question.id}}" class="entries" ng-mouseup="saveRange()" ng-keyup="saveRange()"></div>
				<p class="text-error" 
					ng-show="submitted && !newquestion">
					<span class="label label-important">
						Error
					</span>
					Please enter a question.
				</p>
				
				<a class="btn btn-info" ng-click="previewTextEdit(question); showpreviewEdit=true;">
					<i class="icon-eye-open"></i> Preview
				</a>
				<a class="btn btn-primary" ng-click="editquestion(newtitle, newquestion, question);switchEdits(-1);submitted=true">
					<i class="icon-ok"></i> Submit
				</a>
				
				<div class="preview" ng-show="showpreviewEdit" mathjax-bind="previewEdit" ></div>
					
				</form>
			</div>
		</li>
	</ul>
</div>
